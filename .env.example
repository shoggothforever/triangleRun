# ============================================
# 三角机构TRPG单人引擎 - 环境变量配置
# ============================================
# 
# 使用说明:
# 1. 复制此文件为 .env: cp .env.example .env
# 2. 根据环境修改配置值
# 3. 生产环境必须更新所有密码和密钥
# 4. 不要将 .env 文件提交到版本控制
#
# ============================================

# ============================================
# 服务器配置
# ============================================
# 服务器监听端口
SERVER_PORT=8080

# 运行模式: debug（开发）, release（生产）, test（测试）
# 生产环境必须使用 release
SERVER_MODE=debug

# 超时配置（秒）
SERVER_READ_TIMEOUT=30
SERVER_WRITE_TIMEOUT=30
SERVER_IDLE_TIMEOUT=120

# ============================================
# 数据库配置 (PostgreSQL)
# ============================================
# 数据库主机地址
# Docker: postgres, Kubernetes: postgres-service, 本地: localhost
DATABASE_HOST=localhost

# 数据库端口
DATABASE_PORT=5432

# 数据库用户名
DATABASE_USER=trpg

# 数据库密码
# ⚠️ 生产环境必须使用强密码！
DATABASE_PASSWORD=trpg_password

# 数据库名称
DATABASE_NAME=trpg_solo_engine

# SSL模式: disable（开发）, require（生产推荐）, verify-ca, verify-full
DATABASE_SSLMODE=disable

# 连接池配置
DATABASE_MAX_OPEN_CONNS=25
DATABASE_MAX_IDLE_CONNS=5
DATABASE_CONN_MAX_LIFETIME=300

# 自动迁移（生产环境建议设为false，手动执行迁移）
DATABASE_AUTO_MIGRATE=true

# ============================================
# Redis配置
# ============================================
# Redis主机地址
# Docker: redis, Kubernetes: redis-service, 本地: localhost
REDIS_HOST=localhost

# Redis端口
REDIS_PORT=6379

# Redis密码（如果设置了密码）
# ⚠️ 生产环境建议设置密码
REDIS_PASSWORD=

# Redis数据库编号（0-15）
REDIS_DB=0

# 连接池配置
REDIS_POOL_SIZE=10
REDIS_MIN_IDLE_CONNS=2

# ============================================
# AI服务配置
# ============================================
# AI提供商: openai, azure, local
AI_PROVIDER=openai

# API密钥
# ⚠️ 必须填入有效的API密钥
AI_API_KEY=your_api_key_here

# 模型名称
# OpenAI: gpt-4, gpt-3.5-turbo
# Azure: 部署名称
AI_MODEL=gpt-4

# 自定义API基础URL（可选）
# Azure示例: https://your-resource.openai.azure.com/
AI_BASE_URL=

# 请求超时（秒）
AI_TIMEOUT=30

# 最大token数
AI_MAX_TOKENS=2000

# 温度参数（0.0-2.0，越高越随机）
AI_TEMPERATURE=0.7

# 启用响应缓存
AI_ENABLE_CACHE=true

# ============================================
# 认证配置
# ============================================
# JWT密钥
# ⚠️ 生产环境必须使用强随机密钥！
# 生成方法: openssl rand -base64 32
JWT_SECRET=your-secret-key-change-in-production

# JWT过期时间（秒）
JWT_EXPIRATION=86400  # 24小时

# 刷新令牌过期时间（秒）
JWT_REFRESH_EXPIRATION=604800  # 7天

# 启用认证（开发环境可关闭，生产环境必须开启）
ENABLE_AUTH=false

# ============================================
# 速率限制配置
# ============================================
# 启用速率限制
RATE_LIMIT_ENABLED=true

# 全局最大请求数（每窗口）
RATE_LIMIT_GLOBAL_MAX_REQUESTS=1000

# 时间窗口（秒）
RATE_LIMIT_GLOBAL_WINDOW=60

# ============================================
# 日志配置
# ============================================
# 日志级别: debug, info, warn, error, fatal
# 开发: debug, 生产: info或warn
LOG_LEVEL=info

# 日志格式: json（生产推荐）, console（开发友好）
LOG_FORMAT=json

# 日志输出: stdout, stderr, file
LOG_OUTPUT=stdout

# 日志文件路径（当LOG_OUTPUT=file时使用）
LOG_FILE_PATH=logs/app.log

# 启用调用者信息（文件名和行号）
LOG_ENABLE_CALLER=true

# ============================================
# 游戏配置
# ============================================
# 剧本文件目录
SCENARIOS_PATH=scenarios

# ARC配置文件目录
ARC_CONFIGS_PATH=configs

# 会话超时时间（秒）
SESSION_TIMEOUT=86400  # 24小时

# 自动保存间隔（秒）
AUTO_SAVE_INTERVAL=300  # 5分钟

# ============================================
# CORS配置
# ============================================
# 启用CORS
CORS_ENABLED=true

# 允许的源（逗号分隔）
# 生产环境必须指定具体域名
CORS_ALLOW_ORIGINS=http://localhost:3000,http://localhost:5173

# 允许携带凭证
CORS_ALLOW_CREDENTIALS=true

# ============================================
# 监控配置
# ============================================
# 启用监控
MONITORING_ENABLED=true

# 启用Prometheus指标
PROMETHEUS_ENABLED=true

# 启用分布式追踪
TRACING_ENABLED=false

# ============================================
# 开发配置（生产环境应全部禁用）
# ============================================
# 启用pprof性能分析
ENABLE_PPROF=false

# pprof端口
PPROF_PORT=6060

# 启用Swagger文档
# ⚠️ 生产环境建议禁用
ENABLE_SWAGGER=true

# 使用模拟AI（用于测试，不调用真实API）
MOCK_AI=false

# 加载种子数据（用于开发测试）
SEED_DATA=false

# ============================================
# Docker Compose特定配置
# ============================================
# 构建版本信息
VERSION=dev
BUILD_TIME=
GIT_COMMIT=

# Nginx端口
NGINX_HTTP_PORT=80
NGINX_HTTPS_PORT=443

# Prometheus端口
PROMETHEUS_PORT=9090

# Grafana端口
GRAFANA_PORT=3001
GRAFANA_USER=admin
GRAFANA_PASSWORD=admin

# ============================================
# 生产环境检查清单
# ============================================
# 
# 部署到生产环境前，请确保：
# 
# ✓ SERVER_MODE=release
# ✓ DATABASE_PASSWORD 使用强密码
# ✓ REDIS_PASSWORD 已设置
# ✓ AI_API_KEY 已填入有效密钥
# ✓ JWT_SECRET 使用强随机密钥
# ✓ ENABLE_AUTH=true
# ✓ CORS_ALLOW_ORIGINS 指定具体域名
# ✓ LOG_LEVEL=info 或 warn
# ✓ ENABLE_SWAGGER=false
# ✓ ENABLE_PPROF=false
# ✓ DATABASE_SSLMODE=require（如果数据库支持）
# ✓ 所有超时和限制参数根据实际需求调整
#
# ============================================

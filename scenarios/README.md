# 三角机构剧本数据

本目录包含《三角机构》TRPG系统的剧本数据文件。

## 剧本列表

### 永恒之泉 (Eternal Spring)
- **文件**: `eternal-spring.json`
- **异常体**: 永恒之泉 (Fountain of Youth)
- **焦点**: 渴望 - 回到某个失去的时光或自我
- **领域**: 三联城下水道中的雨林
- **主题**: 青春、美丽、失去与接受
- **难度**: 中等
- **场景数量**: 5个主要场景
- **NPC数量**: 5个关键NPC
- **线索数量**: 13条线索
- **混沌效应**: 5种效应

## 剧本结构

每个剧本JSON文件包含以下主要部分：

### 1. 基本信息
```json
{
  "id": "剧本唯一标识符",
  "name": "剧本名称",
  "description": "剧本简介"
}
```

### 2. 异常体档案 (anomaly)
- 异常体的历史、外观、冲动
- 焦点（情感 + 主题）
- 领域（地点 + 描述）
- 混沌效应列表

### 3. 任务前夕
- **晨会场景** (morning_scenes): 4-5个可选的日常场景
- **任务简报** (briefing): 任务目标、警告
- **可选目标** (optional_goals): 额外的挑战和奖励

### 4. 调查阶段 (scenes)
每个场景包含：
- 场景描述
- NPC列表（带对话）
- 线索列表（带解锁条件）
- 事件列表（带触发条件）
- 场景连接（可前往的其他场景）

### 5. 遭遇阶段 (encounter)
- 遭遇描述
- 多个阶段（phases）
- 每个阶段的可用行动

### 6. 余波 (aftermath)
三种可能的结局：
- 已捕获 (captured)
- 已中和 (neutralized)
- 已逃脱 (escaped)

### 7. 奖励 (rewards)
- 嘉奖次数
- 可申领物列表

## 数据验证

所有剧本数据都经过以下验证：

1. **结构完整性**: 所有必需字段都存在
2. **引用有效性**: 场景连接、线索解锁等引用都指向存在的对象
3. **数据合理性**: 数值范围、数量要求等符合游戏规则
4. **内容完整性**: 描述、对话等文本内容不为空

运行验证测试：
```bash
go test -v ./internal/service -run TestScenario
```

## 创建新剧本

创建新剧本时，请遵循以下步骤：

1. 复制 `eternal-spring.json` 作为模板
2. 修改所有ID和名称
3. 设计异常体档案（焦点和领域是核心）
4. 创建至少3个调查场景
5. 设计3-5个NPC，每个至少3条对话
6. 创建至少5条线索，形成调查链
7. 设计2-3个动态事件
8. 创建3-5个混沌效应
9. 设计遭遇阶段（至少2个阶段）
10. 编写三种结局的余波描述

### 最低要求
- 场景数量: ≥ 3
- NPC数量: ≥ 3
- 线索数量: ≥ 5
- 混沌效应: ≥ 3
- 晨会场景: ≥ 3
- 遭遇阶段: ≥ 2

## 剧本设计原则

1. **焦点驱动**: 异常体的焦点应该贯穿整个剧本
2. **线索链**: 线索应该形成逻辑链，引导玩家找到领域
3. **NPC深度**: 每个NPC都应该有清晰的动机和性格
4. **动态事件**: 事件应该根据玩家行动和混沌池触发
5. **多重结局**: 提供多种解决方案，不强制单一路径
6. **主题一致**: 所有元素都应该服务于剧本的核心主题

## 技术说明

- 文件格式: JSON (UTF-8编码)
- 命名规范: kebab-case (如 `eternal-spring.json`)
- ID规范: kebab-case (如 `fountain-of-youth`)
- 文本长度: 描述建议100-500字，对话建议20-100字

## 相关文档

- [剧本模型详细说明](../.kiro/specs/trpg-solo-engine/scenario-model.md)
- [设计文档](../.kiro/specs/trpg-solo-engine/design.md)
- [需求文档](../.kiro/specs/trpg-solo-engine/requirements.md)
